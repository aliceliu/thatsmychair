<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
	<title>THAT'S MY CHAIR</title>
	<link rel="stylesheet" href="static/css/bootstrap.min.css">
	<style>
	</style>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script>
		var canvas = null;
		var ctx = null;
		var chairs = [];
		var people = [];
		var playing = false;
		
		// 2. This code loads the IFrame Player API code asynchronously.
        var tag = document.createElement('script');
        tag.src = "//www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        
        // 3. This function creates an <iframe> (and YouTube player)
        //    after the API code downloads.
        var player;
        function onYouTubeIframeAPIReady() {
        
            player = new YT.Player('player', {
            height: '390',
            width: '640',
            videoId: 'dQw4w9WgXcQ',
            
            events: {
                'onReady': onPlayerReady,
                }
            });
            
            
        }

        // 4. The API will call this function when the video player is ready.
        function onPlayerReady(event) {
            $('#player').hide();
            event.target.playVideo();
            playing = true;
            var duration = Math.random() * 1000 * 15 + 2000;
            setTimeout('pause()', duration);
            
        }
        
        function pause() {
            player.pauseVideo();  
        }
		
		function setup(number) {
			canvas = document.createElement('canvas');
			ctx = canvas.getContext('2d');
			canvas.width = 800;
			canvas.height = 800;
			$('#playground').append(canvas);
			var x_offset = 450;
			var y_offset = 220;
			
			ctx.font = "bold 12px sans-serif";
			ctx.fillText("Press left or right", 440, 240);
			ctx.fillText("when music stops", 440, 270);
			
			var angle = 0;
			var radius = 13 * number;
			var index = 0;
			var drawChairs = function() {
				var x = Math.sin(angle) * radius + x_offset;
				var y = Math.cos(angle) * radius + y_offset;
				angle = angle + 2*Math.PI/(number - 1);
				ctx.drawImage(chairs[index].picture, x, y);
				chairs[index].x = x;
				chairs[index].y = y;
				index++;
			};
			for (var i = 0; i < number - 1; i++) {//initialize chair objects
			    var img = new Image();
			    img.onload = drawChairs;
        		img.src = '/static/chair.jpg';
        		var chair = new Chair(img);
      			chairs.push(chair);	
			}
			
			
			var outer_angle = 0;
			var outer_radius = 13 * number + 80;
			var human_index = 0;
			var drawPlayer = function() {
				var x = Math.sin(outer_angle) * outer_radius + x_offset;
				var y = Math.cos(outer_angle) * outer_radius + y_offset;
				outer_angle = outer_angle + 2*Math.PI/number;
				//alert(people[human_index].picture);
				ctx.drawImage(people[human_index].picture, x, y);
				people[human_index].x = x;
				people[human_index].y = y;
				human_index++;
			}
			for (var i = 0; i < number; i++) {//initialize people objects
			    var img = new Image();
			    img.onload = drawPlayer;
			    if (i == 0) {
        			img.src = '/static/you.jpg';
        			var person = new Human(img);
        		}
        		else {
        			img.src = '/static/smiley.jpg';
        			var person = new Player(img);
        		}        		
      			people.push(person);	
			}
			
		};
		
		
		function Player(picture) {
		    this.picture = picture;
		    this.chair = null;
		}
		
		
		function Human(picture) {
		    this.picture = picture;
		    this.chair = null;
		    this.human = true;
		    
		}
		
		
		function Chair(picture) {
		    this.picture = picture;
		    this.person = null;
		    this.x = 0;
		    this.y = 0;
		}
		
		function changePosition() {
		}
		
		function Main() {
        	setup(10);
        	while (playing) {
        	    animate();
        	}
			
			
			
			
        };
        
        $(document).ready(Main);
	</script>

</head>
<body>
 	<div id="playground"></div>
 	
 	<div id="player"></div>
</body>
</html>